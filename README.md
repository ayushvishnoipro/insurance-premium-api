# ğŸ¥ Insurance Premium Category Prediction API

[![FastAPI](https://img.shields.io/badge/FastAPI-005571?style=for-the-badge&logo=fastapi)](https://fastapi.tiangolo.com/)
[![Python](https://img.shields.io/badge/python-3.11+-blue.svg?style=for-the-badge&logo=python&logoColor=white)](https://www.python.org)
[![Docker](https://img.shields.io/badge/docker-%230db7ed.svg?style=for-the-badge&logo=docker&logoColor=white)](https://www.docker.com/)
[![AWS](https://img.shields.io/badge/AWS-%23FF9900.svg?style=for-the-badge&logo=amazon-aws&logoColor=white)](https://aws.amazon.com/)
[![Streamlit](https://img.shields.io/badge/Streamlit-%23FE4B4B.svg?style=for-the-badge&logo=streamlit&logoColor=white)](https://streamlit.io/)

## ğŸ“– Introduction

This project demonstrates **how to build a complete Machine Learning API using FastAPI**, containerize it with Docker, and deploy it on AWS EC2. The Insurance Premium Category Prediction API predicts insurance premium categories (Low/Medium/High) based on user demographics and lifestyle factors.

This is an educational project designed to teach:
- Building ML APIs with FastAPI
- Docker containerization
- AWS EC2 deployment
- Model serving best practices
- Frontend integration with Streamlit

## âœ¨ Features

- ğŸ¤– **Machine Learning Model**: Scikit-learn classifier for insurance premium prediction
- ğŸš€ **FastAPI Backend**: High-performance async API with automatic documentation
- ğŸ³ **Docker Support**: Fully containerized application
- â˜ï¸ **AWS Deployment**: Production-ready deployment on EC2
- ğŸ¨ **Streamlit Frontend**: Interactive web interface for testing
- ğŸ“ **Data Validation**: Pydantic schemas for robust input validation
- ğŸ“Š **Model Insights**: Confidence scores and class probabilities
- ğŸ¥ **Health Checks**: API monitoring and status endpoints

## ğŸ› ï¸ Tech Stack

- **Backend**: FastAPI, Python 3.11+
- **ML Framework**: Scikit-learn, Pandas, NumPy
- **Frontend**: Streamlit
- **Containerization**: Docker
- **Cloud**: AWS EC2
- **Data Validation**: Pydantic
- **API Documentation**: Swagger UI (auto-generated)

## ğŸ“ Project Structure

```
improved_api/
â”œâ”€â”€ app.py                      # Main FastAPI application
â”œâ”€â”€ frontend.py                 # Streamlit web interface
â”œâ”€â”€ Dockerfile                  # Docker configuration
â”œâ”€â”€ requirements.txt            # Python dependencies
â”œâ”€â”€ README.md                   # Project documentation
â”‚
â”œâ”€â”€ model/
â”‚   â”œâ”€â”€ model.pkl              # Trained ML model (pickle)
â”‚   â””â”€â”€ predict.py             # Prediction logic
â”‚
â”œâ”€â”€ schema/
â”‚   â”œâ”€â”€ user_input.py          # Input data validation schema
â”‚   â””â”€â”€ prediction_response.py # API response schema
â”‚
â”œâ”€â”€ config/
â”‚   â””â”€â”€ city_tier.py           # City tier classification
â”‚
â””â”€â”€ myenv/                     # Virtual environment (local)
```

## ğŸ”§ FastAPI Overview

FastAPI provides:
- **Automatic API Documentation**: Interactive docs at `/docs`
- **Type Safety**: Pydantic models for request/response validation
- **High Performance**: Async support and fast serialization
- **Easy Testing**: Built-in testing support

### Key Endpoints:
- `GET /` - Welcome message
- `GET /health` - Health check and model status
- `POST /predict` - Insurance premium prediction

## ğŸ§  Model Training and Development

The project uses a trained machine learning model saved as `model.pkl` that predicts insurance premium categories based on user demographics and lifestyle factors. The model processes features like BMI, age group, lifestyle risk, city tier, income, and occupation to make predictions.

## ğŸš€ FastAPI Application Structure

The FastAPI application consists of:
- **Data Models**: Pydantic schemas for input validation and response formatting
- **Prediction Logic**: Model loading and inference functionality  
- **API Endpoints**: RESTful endpoints for health checks and predictions
- **Automatic Documentation**: Interactive API docs generated by FastAPI

## ğŸ³ Dockerization

![image](https://github.com/user-attachments/assets/f89cfa65-a04c-4347-a66c-cb9144e5eef6)

### Docker Commands

```bash
# Build Docker image
docker build -t insurance-premium-api .

# Run container locally
docker run -p 8000:8000 insurance-premium-api

# Tag for Docker Hub
docker tag insurance-premium-api ayushvishnoi/insurance-premium-api:latest

# Push to Docker Hub
docker push ayushvishnoi/insurance-premium-api:latest
```

### ğŸ‹ Docker Hub Repository
[https://hub.docker.com/repository/docker/ayushvishnoi/insurance-premium-api](https://hub.docker.com/repository/docker/ayushvishnoi/insurance-premium-api)

<!-- Add Docker Hub link screenshot here -->

## â˜ï¸ AWS EC2 Deployment

### Deploy Container on EC2
```bash
# Pull and run the Docker container
docker pull ayushvishnoi/insurance-premium-api:latest

# Run container
docker run -d -p 8000:8000 --name insurance-api ayushvishnoi/insurance-premium-api:latest

# Check if container is running
docker ps
```

### Access API
- API will be available at: `http://your-ec2-public-ip:8000`
- API Documentation: `http://your-ec2-public-ip:8000/docs`

<!-- Add EC2 deployment image here -->

## ğŸ§ª API Testing

![image](https://github.com/user-attachments/assets/d776964f-4870-4bd9-8a44-b48eaf865cd8)

### Sample cURL Requests

```bash
# Health check
curl -X GET "http://your-ec2-public-ip:8000/health"

# Prediction request
curl -X POST "http://your-ec2-public-ip:8000/predict" \
     -H "Content-Type: application/json" \
     -d '{
       "age": 35,
       "weight": 75.5,
       "height": 1.75,
       "income_lpa": 12.5,
       "smoker": false,
       "city": "Mumbai",
       "occupation": "private_job"
     }'
```

### Example Input/Output

![image](https://github.com/user-attachments/assets/9311a7c4-672e-4934-8167-a765d4fccd50)

**Input:**
```json
{
  "age": 35,
  "weight": 75.5,
  "height": 1.75,
  "income_lpa": 12.5,
  "smoker": false,
  "city": "Mumbai",
  "occupation": "private_job"
}
```

**Output:**

![image](https://github.com/user-attachments/assets/73bca857-ae18-4190-be00-8c5b40402456)

```json
{
  "response": {
    "predicted_category": "Medium",
    "confidence": 0.8432,
    "class_probabilities": {
      "Low": 0.01,
      "Medium": 0.84,
      "High": 0.15
    }
  }
}
```

## ğŸ¨ Streamlit Frontend

![image](https://github.com/user-attachments/assets/6435945f-a310-4509-b454-727f96536908)

- **Developer**: Ayush Vishnoi
- **Docker Hub**: [ayushvishnoi](https://hub.docker.com/u/ayushvishnoi)
- **Project Repository**: [GitHub](https://github.com/your-username/insurance-premium-api)

---

â­ **Star this repository if it helped you learn FastAPI and ML deployment!**

*Built with â¤ï¸ for learning FastAPI, Docker, and AWS deployment*
